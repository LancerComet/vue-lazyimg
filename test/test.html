<html>
  <head>
    <meta charset="utf-8">
  </head>

  <body>
    <div style="height: 1000px; background-color: red"></div>
    <img :v-lazy="img1">
    <div style="height: 1000px; background-color: red"></div>
    <img :v-lazy="img2">
    <div style="height: 1000px; background-color: red"></div>
    <div style="height: 500px" :v-lazy-bg="img1"></div>

    <script src="http://cdn.bootcss.com/vue/1.0.26/vue.min.js"></script>
    
    <script>
       /*
        *  LazyImg for lazying loading images by using Vue.
        *  By LancerComet at 22:07, 2016.08.18.
        *  # Carry Your World #
        */

        // Module Configuration.
        var directives = ['v-lazy-bg', 'v-lazy']
        var inited = false

        var LazyImg = {
          install: function (Vue, options) {
            if (inited) return
            document.readyState === 'complete' ? init() : document.addEventListener('DOMContentLoaded', init)
          }
        }

        // Initilization.
        function init () {
          // Start lazyInit for once.
          lazyImg()

          // Execute when scrolling.
          var events = ['resize', 'scroll']
          events.forEach(function (event) { window.addEventListener(event, throttle(lazyImg, 200)) })

          inited = true
        }

        // Main function of LazyImg.
        function lazyImg () {
          console.log('lazyImg')          
          // Get all nodes that are needed to be lazyed.
          directives.forEach(function (directive) {
            var nodes = getDoms(document.querySelectorAll('[' + directive + ']'))
            nodes.forEach(function (node) { lazyExec(node, directive) })
          })

        }

        // LazyImg dom controller.
        function lazyExec (node, directive) {
          // @ node: HTML Element Object.
          // @ directive: 'v-lazy' or 'v-lazy-bg'.

          // Size.
          var viewportHeight = window.innerHeight
          var scrollTop = document.body.scrollTop

          // Check and see the position of this node.
          // Attach image link or not.
          if (scrollTop + viewportHeight - node.offsetTop > 0 && node.hasAttribute(directive)) {
            var imgLink = node.attributes[directive].value
            switch (directive) {
              case directives[0]:
                node.style.backgroundImage = 'url(' + imgLink + ')'
                break
              case directives[1]:
                node.src = imgLink
                break  
            }
            node.removeAttribute(directive)
          }
        }

        // Transform DOM Collection to Array.
        function getDoms (doms) {
          return Array.prototype.slice.call(doms)
        }

        // Throttle function.
        // Underscore (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors.
        // Underscore may be freely distributed under the MIT license.
        function throttle (func, wait, options) {
            var context, args, result;
            var timeout = null;
            var previous = 0;
            if (!options) options = {};
            var later = function() {
                previous = options.leading === false ? 0 : Date.now();
                timeout = null;
                result = func.apply(context, args);
                if (!timeout) context = args = null;
            };
            return function () {
                var now = Date.now();
                if (!previous && options.leading === false) previous = now;
                var remaining = wait - (now - previous);
                context = this;
                args = arguments;
                if (remaining <= 0 || remaining > wait) {
                    if (timeout) {
                        clearTimeout(timeout);
                        timeout = null;
                    }
                    previous = now;
                    result = func.apply(context, args);
                    if (!timeout) context = args = null;
                } else if (!timeout && options.trailing !== false) {
                    timeout = setTimeout(later, remaining);
                }
                return result;
            };
        }
    </script>

    <script>
      Vue.use(LazyImg)
      
      const Root = new Vue({
        el: 'body',
        data: {
          img1: 'http://i0.hdslb.com/bfs/drawyoo/e6852b4b78a47987c9ce3e1f7491531a0b1ec19d.jpg?key=GH7Ex1jFCKagna5vd1Exaw&expires=1471535400',
          img2: 'http://i0.hdslb.com/bfs/drawyoo/b778230b599f12b1b90ba672618400f49184eaa1.jpg?key=i_uQ5npF-K1ObYAeBqvJyQ&expires=1471535396'
        }
      })
    </script>
        
  </body>
</html>